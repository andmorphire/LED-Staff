#include "FastLED.h"

// This sketch shows how to sequence a performance using HH,MM,SS.SSS timecode.
//
// A "ResetPerformance" method is provided so that the performance can be
// restarted from a custom external trigger, e.g., a button or event.
// For demonstration purposes, this Performance is reset if the
// sketch receives a letter "r" on the serial port.
//
// -Mark Kriegsman, January 2015

#if FASTLED_VERSION < 3001000
#error "Requires FastLED 3.1 or later; check github for latest code."
#endif

#define DATA_PIN    3
//#define CLK_PIN   4
#define LED_TYPE    WS2812B
#define COLOR_ORDER GRB
#define NUM_LEDS    90
CRGB leds[NUM_LEDS];

#define BRIGHTNESS          255
#define FRAMES_PER_SECOND  240


#define FREQUENCY     5                // controls the interval between strikes for lightning
#define FLASHES       20                 // the upper limit of flashes per strike for lightning
// #define color White; //for lightning- do we need this?
unsigned int dimmer = 1; // for lightning


uint8_t hue = 32;  //for meteor
byte idex = 255;   //for meteor
byte meteorLength = 29;  //for meteor


void setup() {
  delay(300); // 0.3 second delay for recovery
  
  // tell FastLED about the LED strip configuration
  FastLED.addLeds<LED_TYPE,DATA_PIN,COLOR_ORDER>(leds, NUM_LEDS).setCorrection(TypicalLEDStrip);
  //FastLED.addLeds<LED_TYPE,DATA_PIN,CLK_PIN,COLOR_ORDER>(leds, NUM_LEDS).setCorrection(TypicalLEDStrip);

  // set master brightness control
  FastLED.setBrightness(BRIGHTNESS);
  
  // RestartPerformance();
  Serial.begin(57600);
}


uint8_t gHue = 0; // rotating "base color" used by many of the patterns
  
uint32_t gTimeCodeBase = 0;
uint32_t gTimeCode = 0;
uint32_t gLastTimeCodeDoneAt = 0;
uint32_t gLastTimeCodeDoneFrom = 0;

#define TC(HOURS,MINUTES,SECONDS) \
  ((uint32_t)(((uint32_t)((HOURS)*(uint32_t)(3600000))) + \
  ((uint32_t)((MINUTES)*(uint32_t)(60000))) + \
  ((uint32_t)((SECONDS)*(uint32_t)(1000)))))


#define AT(HOURS,MINUTES,SECONDS) if( atTC(TC(HOURS,MINUTES,SECONDS)) )
#define FROM(HOURS,MINUTES,SECONDS) if( fromTC(TC(HOURS,MINUTES,SECONDS)) )

static bool atTC( uint32_t tc)
{
  bool maybe = false;
  if( gTimeCode >= tc) {
    if( gLastTimeCodeDoneAt < tc) {
      maybe = true;
      gLastTimeCodeDoneAt = tc;
    }
  }
  return maybe;
}

static bool fromTC( uint32_t tc)
{
  bool maybe = false;
  if( gTimeCode >= tc) {
    if( gLastTimeCodeDoneFrom <= tc) {
      maybe = true;
      gLastTimeCodeDoneFrom = tc;
    }
  }
  return maybe;
}


// There are two kinds of things you can put into this performance:
// "FROM" and "AT".
//
// * "FROM" means starting FROM this time AND CALLING IT REPEATEDLY 
//   until the next "FROM" time comes.
//
// * "AT" means do this ONE TIME ONLY "AT" the designated time.
//
// At least one of the FROM clauses will ALWAYS be executed.
// In the transitional times, TWO pieces of code will be executed back to back.
// For example, if one piece says "FROM(0,0,1.000) {DrawRed()}" and another says
// "FROM(0,0,2.000) {flashblue();}", what you'll get is this:
//   00:00:01.950  -> calls DrawRed
//   00:00:01.975  -> calls DrawRed
//   00:00:02.000  -> calls DrawRed AND calls DrawBlue !
//   00:00:02.025  -> calls DrawBlue
//   00:00:02.050  -> calls DrawBlue
// In most cases, this probably isn't significant in practice, but it's important
// to note.  It could be avoided by listing the sequence steps in reverse
// chronological order, but that makes it hard to read.

void Performance()
{
    AT(0,0,00.001) { FastLED.setBrightness(BRIGHTNESS); }
  FROM(0,0,00.100) { sinelon(); }
  FROM(0,0,07.120) { meteor(); }
  FROM(0,0,17.010) { confetti(); }
  FROM(0,0,25.760) { rainbow(); }
  FROM(0,0,33.000) { fadeToBlack(); }
  FROM(0,0,34.050) { lightning(); }
  FROM(0,0,42.930) { povA(); }
  FROM(0,0,52.650) { juggle(); }
  FROM(0,1,00.930) { bpm(); }
  FROM(0,1,10.070) { colorshift(); }
  FROM(0,1,20.560) { sinelon(); }
  FROM(0,1,26.810) { juggle(); }
  FROM(0,1,32.810) { meteor(); }
  FROM(0,1,41.000) { fadeToBlack(); }
  FROM(0,1,42.000) { lightning(); }
  FROM(0,1,51.690) { povB(); }
  FROM(0,2,02.020) { povA(); }
  FROM(0,2,14.180) { rainbowWithGlitter(); }
  FROM(0,2,22.590) { colorshift(); }
  FROM(0,2,26.750) { povB(); }
  FROM(0,2,31.750) { confetti(); }
    AT(0,2,32.000)   { gHue = HUE_PINK; }
    AT(0,2,33.000)   { fill_solid(leds, NUM_LEDS, CRGB::Red); }
    AT(0,2,34.000)   { fill_solid(leds, NUM_LEDS, CRGB::Blue); } 
  FROM(0,2,35.000) { applause(); }  
    AT(0,2,36.000)   { FastLED.setBrightness(BRIGHTNESS/2); }
    AT(0,2,37.000)   { FastLED.setBrightness(BRIGHTNESS/4); }
    AT(0,2,38.000)   { FastLED.setBrightness(BRIGHTNESS/8); }
    AT(0,2,39.000)   { FastLED.setBrightness(BRIGHTNESS/16); }
  FROM(0,2,40.000) { fadeToBlack(); }  
}


void loop()
{
  // Set the current timecode, based on when the performance started
  gTimeCode = millis() - gTimeCodeBase;

  Performance();

  // send the 'leds' array out to the actual LED strip
  FastLED.show();  
  // insert a delay to keep the framerate modest
  FastLED.delay(1000/FRAMES_PER_SECOND); 

  // For demo purposes, restart the performance any time we read
  // the letter "r" character from the serial port.  Type "r" into 
  // the Arduino serial monitor and press return to restart the performance.
  // In practice, you could have this check a 'restart' button, or something similar.
  // if( Serial.read() == 'r') RestartPerformance();

  // do some periodic updates
  EVERY_N_MILLISECONDS( 20 ) { gHue++; } // slowly cycle the "base color" through the rainbow
}


void RestartPerformance()
{
  gLastTimeCodeDoneAt = 0;
  gLastTimeCodeDoneFrom = 0;
  gTimeCodeBase = millis();
}

void rainbow() 
{
  // FastLED's built-in rainbow generator
  fill_rainbow( leds, NUM_LEDS, gHue, 7);
}

void rainbowWithGlitter() 
{
  // built-in FastLED rainbow, plus some random sparkly glitter
  rainbow();
  addGlitter(80);
}

void addGlitter( fract8 chanceOfGlitter) 
{
  if( random8() < chanceOfGlitter) {
    leds[ random16(NUM_LEDS) ] += CRGB::White;
  }
}

void confetti() 
{
  // random colored speckles that blink in and fade smoothly
  fadeToBlackBy( leds, NUM_LEDS, 10);
  int pos = random16(NUM_LEDS);
  leds[pos] += CHSV( gHue + random8(64), 200, 255);
}

void bpm()
{
  // colored stripes pulsing at a defined Beats-Per-Minute (BPM)
  uint8_t BeatsPerMinute = 62;
  CRGBPalette16 palette = PartyColors_p;
  uint8_t beat = beatsin8( BeatsPerMinute, 64, 255);
  for( int i = 0; i < NUM_LEDS; i++) { //9948
    leds[i] = ColorFromPalette(palette, gHue+(i*2), beat-gHue+(i*10));
  }
}

void juggle() {
  // eight colored dots, weaving in and out of sync with each other
  fadeToBlackBy( leds, NUM_LEDS, 20);
  byte dothue = 0;
  for( int i = 0; i < 8; i++) {
    leds[beatsin16(i+7,0,NUM_LEDS -1)] |= CHSV(dothue, 200, 255);
    dothue += 32;
  }
}

void sinelon()
{
  // a colored dot sweeping back and forth, with fading trails
  fadeToBlackBy( leds, NUM_LEDS, 20);
  int pos = beatsin16(13,0,NUM_LEDS -1);
  leds[pos] += CHSV( gHue, 255, 192);
}

//void twosinelon()
//{
//  // a colored dot sweeping back and forth, with fading trails
//  fadeToBlackBy( leds, NUM_LEDS, 20);
//  int pos = beatsin16(13,0,NUM_LEDS -1);
//  int pos2 = beatsin16(13,NUM_LEDS -1,1);
//  leds[pos] += CHSV( gHue, 255, 192);
//  leds[pos2] += CHSV( gHue, 255, 192);
//}

// An animation to play while the crowd goes wild after the big performance
void applause()
{
  static uint16_t lastPixel = 0;
  fadeToBlackBy( leds, NUM_LEDS, 32);
  leds[lastPixel] = CHSV(random8(HUE_BLUE,HUE_PURPLE),255,255);
  lastPixel = random16(NUM_LEDS);
  leds[lastPixel] = CRGB::White;
}

// An "animation" to just fade to black.  Useful as the last track
// in a non-looping performance.
void fadeToBlack()
{
  fadeToBlackBy( leds, NUM_LEDS, 1);
}

const byte dataA[] PROGMEM = {3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,136,0,0,136,0,0,255,16,0,255,16,0,255,49,0,255,49,0,255,49,0,255,49,0,255,16,0,177,0,0,136,0,0,97,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,3,0,0,46,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,97,0,0,177,0,0,255,16,0,255,49,0,255,78,0,255,78,0,255,78,0,255,111,0,255,111,0,255,138,1,255,138,1,255,111,0,255,49,0,255,16,0,136,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,46,0,0,46,0,0,97,0,0,136,0,0,97,0,0,136,0,0,136,0,0,136,0,0,136,0,0,97,0,0,46,0,0,46,0,0,3,0,0,46,0,0,3,0,0,3,0,0,3,0,0,255,16,0,255,16,0,97,0,0,136,0,0,97,0,0,177,0,0,177,0,0,255,16,0,255,49,0,255,78,0,255,111,0,255,78,0,255,78,0,255,78,0,255,78,0,255,138,1,255,178,9,255,205,22,255,178,9,255,138,1,255,49,0,177,0,0,46,0,0,3,0,0,46,0,0,46,0,0,3,0,0,46,0,0,97,0,0,97,0,0,136,0,0,136,0,0,177,0,0,255,16,0,255,49,0,255,78,0,255,78,0,255,78,0,255,78,0,255,49,0,255,49,0,177,0,0,136,0,0,136,0,0,97,0,0,97,0,0,46,0,0,46,0,0,97,0,0,97,0,0,255,16,0,255,16,0,255,16,0,255,16,0,255,16,0,255,49,0,255,78,0,255,49,0,255,16,0,177,0,0,136,0,0,136,0,0,177,0,0,255,49,0,255,111,0,255,205,22,255,246,74,255,231,45,255,178,9,255,49,0,136,0,0,97,0,0,136,0,0,136,0,0,136,0,0,177,0,0,177,0,0,255,16,0,255,49,0,255,78,0,255,111,0,255,178,9,255,178,9,255,178,9,255,205,22,255,205,22,255,178,9,255,205,22,255,178,9,255,138,1,255,78,0,255,49,0,255,16,0,177,0,0,136,0,0,97,0,0,97,0,0,97,0,0,136,0,0,255,16,0,255,16,0,255,16,0,255,16,0,255,16,0,255,16,0,177,0,0,136,0,0,46,0,0,46,0,0,46,0,0,46,0,0,136,0,0,177,0,0,255,111,0,255,231,45,255,254,115,255,246,74,255,205,22,255,78,0,177,0,0,255,111,0,255,78,0,255,78,0,255,78,0,255,111,0,255,138,1,255,138,1,255,178,9,255,178,9,255,178,9,255,205,22,255,205,22,255,205,22,255,205,22,255,231,45,255,205,22,255,231,45,255,231,45,255,231,45,255,231,45,255,178,9,255,138,1,255,78,0,255,49,0,177,0,0,177,0,0,97,0,0,177,0,0,136,0,0,136,0,0,136,0,0,136,0,0,97,0,0,97,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,136,0,0,177,0,0,255,205,22,255,254,115,255,255,155,255,254,115,255,231,45,255,178,9,255,231,45,255,231,45,255,205,22,255,205,22,255,138,1,255,178,9,255,178,9,255,138,1,255,111,0,255,111,0,255,78,0,255,78,0,255,78,0,255,111,0,255,111,0,255,138,1,255,205,22,255,246,74,255,254,115,255,254,115,255,254,115,255,246,74,255,231,45,255,205,22,255,111,0,255,49,0,177,0,0,136,0,0,136,0,0,97,0,0,97,0,0,46,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,97,0,0,177,0,0,255,205,22,255,254,115,255,255,155,255,255,155,255,255,155,255,254,115,255,254,115,255,231,45,255,231,45,255,178,9,255,138,1,255,78,0,255,49,0,255,16,0,177,0,0,136,0,0,136,0,0,136,0,0,136,0,0,136,0,0,136,0,0,177,0,0,255,111,0,255,205,22,255,254,115,255,255,155,255,255,155,255,255,155,255,255,155,255,254,115,255,246,74,255,205,22,255,138,1,255,78,0,177,0,0,136,0,0,97,0,0,136,0,0,46,0,0,46,0,0,3,0,0,46,0,0,3,0,0,46,0,0,3,0,0,97,0,0,177,0,0,255,78,0,255,231,45,255,255,155,255,255,155,255,255,155,255,255,155,255,255,155,255,246,74,255,205,22,255,138,1,255,78,0,177,0,0,177,0,0,136,0,0,97,0,0,46,0,0,46,0,0,3,0,0,46,0,0,46,0,0,3,0,0,46,0,0,97,0,0,136,0,0,255,111,0,255,231,45,255,254,115,255,255,155,255,255,155,255,255,155,255,255,155,255,254,115,255,231,45,255,205,22,255,178,9,255,111,0,255,78,0,255,49,0,255,16,0,177,0,0,136,0,0,136,0,0,136,0,0,136,0,0,136,0,0,177,0,0,177,0,0,255,78,0,255,231,45,255,254,115,255,254,115,255,255,155,255,255,155,255,255,155,255,254,115,255,111,0,255,49,0,177,0,0,136,0,0,136,0,0,97,0,0,46,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,97,0,0,177,0,0,255,205,22,255,254,115,255,255,155,255,255,155,255,254,115,255,254,115,255,231,45,255,231,45,255,205,22,255,178,9,255,178,9,255,178,9,255,178,9,255,138,1,255,111,0,255,78,0,255,78,0,255,78,0,255,78,0,255,78,0,255,111,0,255,178,9,255,231,45,255,246,74,255,254,115,255,255,155,255,254,115,255,254,115,255,231,45,255,205,22,177,0,0,136,0,0,136,0,0,136,0,0,136,0,0,136,0,0,136,0,0,136,0,0,97,0,0,46,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,97,0,0,177,0,0,255,205,22,255,254,115,255,254,115,255,254,115,255,231,45,255,178,9,255,138,1,255,78,0,255,78,0,255,78,0,255,111,0,255,138,1,255,138,1,255,178,9,255,178,9,255,178,9,255,178,9,255,178,9,255,205,22,255,205,22,255,205,22,255,205,22,255,231,45,255,246,74,255,231,45,255,205,22,255,205,22,255,138,1,255,78,0,255,49,0,136,0,0,97,0,0,136,0,0,255,16,0,255,16,0,255,16,0,255,16,0,255,16,0,255,16,0,177,0,0,97,0,0,97,0,0,46,0,0,46,0,0,46,0,0,97,0,0,177,0,0,255,138,1,255,231,45,255,254,115,255,246,74,255,205,22,255,78,0,177,0,0,136,0,0,136,0,0,136,0,0,136,0,0,177,0,0,255,49,0,255,49,0,255,78,0,255,111,0,255,138,1,255,178,9,255,205,22,255,178,9,255,205,22,255,205,22,255,205,22,255,138,1,255,138,1,255,78,0,255,78,0,255,16,0,177,0,0,136,0,0,97,0,0,46,0,0,136,0,0,255,16,0,255,16,0,255,16,0,255,16,0,255,16,0,255,49,0,255,49,0,255,49,0,255,49,0,177,0,0,136,0,0,136,0,0,177,0,0,255,49,0,255,111,0,255,205,22,255,231,45,255,231,45,255,178,9,255,49,0,177,0,0,97,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,97,0,0,136,0,0,136,0,0,177,0,0,255,16,0,255,49,0,255,78,0,255,78,0,255,78,0,255,49,0,255,49,0,255,49,0,177,0,0,177,0,0,97,0,0,97,0,0,97,0,0,46,0,0,46,0,0,255,16,0,255,16,0,136,0,0,136,0,0,136,0,0,177,0,0,177,0,0,255,16,0,255,78,0,255,78,0,255,78,0,255,78,0,255,78,0,255,78,0,255,78,0,255,138,1,255,178,9,255,205,22,255,205,22,255,111,0,255,49,0,136,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,46,0,0,97,0,0,97,0,0,97,0,0,136,0,0,136,0,0,136,0,0,136,0,0,97,0,0,97,0,0,46,0,0,46,0,0,46,0,0,3,0,0,3,0,0,3,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,46,0,0,97,0,0,177,0,0,255,16,0,255,49,0,255,78,0,255,78,0,255,78,0,255,111,0,255,111,0,255,138,1,255,138,1,255,78,0,255,49,0,255,16,0,136,0,0,97,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,46,0,0,46,0,0,46,0,0,3,0,0,3,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,46,0,0,136,0,0,177,0,0,255,16,0,255,16,0,255,49,0,255,49,0,255,49,0,255,49,0,255,16,0,177,0,0,136,0,0,97,0,0,46,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0,3,0,0};
void povA() {
  int pixels = 48;
  int frames = 16;
  int fps = 600;
  static int currentFrame = 0;

  for (int i=0; i<NUM_LEDS; i++) {
    int pixelIndex = i % pixels;
    int index = currentFrame*pixels*3 + pixelIndex*3;

    // Note: We're using pgm_read_byte_near to read bytes out of the data array stored in PROGMEM. These functions are not required for all configurations
    leds[i] = CRGB(pgm_read_byte_near(dataA+index),pgm_read_byte_near(dataA+index+1),pgm_read_byte_near(dataA+index+2));    
  }
  FastLED.show();
  currentFrame ++;
  if (currentFrame >= frames) currentFrame = 0;
}


const byte dataB[] PROGMEM = {9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,4,2,30,4,2,30,4,2,30,4,2,30,4,2,30,10,2,35,6,3,39,6,3,39,6,3,39,6,3,39,6,3,39,2,4,44,2,4,44,6,3,39,10,2,35,4,2,30,4,2,30,4,2,30,4,2,30,4,2,30,4,2,30,4,2,30,10,2,35,13,4,50,15,4,56,16,4,62,9,4,66,17,3,67,10,5,72,20,8,71,17,3,67,17,3,67,17,3,67,16,4,62,5,4,49,4,2,30,6,2,26,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,1,3,21,1,3,21,1,3,21,1,3,21,1,3,21,0,4,25,6,2,26,6,2,26,4,2,30,2,4,35,6,3,39,10,3,45,13,4,50,15,4,56,16,4,62,8,4,60,15,4,56,15,4,56,13,4,50,13,4,50,13,4,50,7,4,55,7,4,55,13,4,50,5,4,49,10,3,45,10,3,45,10,3,45,10,3,45,10,3,45,10,3,45,13,4,50,15,4,56,20,8,71,28,9,87,34,10,97,35,17,108,43,19,119,43,19,119,34,21,117,44,23,115,44,23,115,30,9,108,30,9,108,25,9,99,21,6,76,15,4,56,13,4,50,10,3,45,6,3,39,4,2,30,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,1,3,21,1,3,21,1,3,21,1,3,21,1,3,21,6,2,26,4,2,30,6,3,39,13,4,50,9,4,66,21,6,76,15,9,82,23,10,92,31,13,103,34,21,117,45,26,131,37,20,123,38,15,114,21,13,107,31,13,103,37,24,100,37,24,100,29,16,92,25,9,99,32,4,99,25,9,99,31,13,103,31,13,103,34,10,97,34,10,97,31,13,103,35,17,108,35,17,108,43,19,119,52,31,137,79,53,162,103,74,187,105,79,198,97,72,198,89,62,186,75,47,177,69,38,162,52,27,141,37,20,123,44,15,124,44,15,124,38,15,114,30,16,98,15,9,82,21,6,76,21,6,76,9,4,66,15,4,56,5,4,49,10,3,45,6,3,39,2,4,35,6,2,26,6,2,26,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,4,2,30,4,2,30,10,2,35,6,3,39,10,3,45,13,4,50,16,4,62,15,9,82,30,6,92,45,30,113,77,61,136,119,101,168,149,133,196,177,163,215,185,177,225,177,163,215,149,133,203,129,116,196,134,117,192,167,150,215,178,158,216,149,133,196,114,96,175,89,69,165,63,40,147,58,32,146,51,17,135,44,22,135,38,17,129,44,22,135,72,45,161,79,49,167,77,49,172,69,38,162,72,37,171,72,37,171,75,47,177,72,37,171,62,30,163,62,30,163,69,38,162,58,37,157,52,23,132,44,15,124,35,8,116,30,9,108,20,6,95,17,7,88,17,7,88,15,9,82,21,6,76,17,3,67,9,4,66,16,4,62,7,4,55,6,3,39,4,2,30,0,4,25,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,6,2,26,6,2,26,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,1,3,21,9,1,21,6,2,26,6,2,26,4,2,30,4,2,30,2,4,35,2,4,35,10,2,35,6,3,39,14,2,40,10,3,45,13,4,50,8,4,60,16,4,62,9,4,66,17,3,67,10,5,72,21,6,76,22,4,81,22,4,81,22,4,81,22,4,81,24,3,88,30,9,108,44,15,124,72,54,148,125,107,181,176,155,227,167,146,218,149,133,196,149,133,203,155,142,211,161,148,218,171,156,220,194,174,234,207,184,239,195,170,238,165,144,229,165,144,229,182,161,233,187,170,235,189,169,229,164,147,204,144,124,194,118,99,185,100,79,183,97,76,186,90,66,183,79,49,167,77,49,172,83,54,185,83,54,185,89,62,186,98,72,190,90,66,183,82,55,179,83,54,185,77,49,172,58,32,146,44,15,124,30,9,108,30,9,108,30,9,108,32,4,99,20,6,95,20,6,95,24,3,88,17,7,88,15,9,82,21,6,76,10,5,72,9,4,66,7,4,55,10,3,45,6,3,39,6,3,39,6,3,39,10,2,35,10,2,35,10,2,35,10,2,35,10,2,35,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,4,2,30,6,3,39,10,3,45,13,4,50,7,4,55,15,4,56,9,4,66,21,6,76,24,3,88,20,6,95,32,4,99,31,13,103,31,13,103,31,13,103,35,17,108,36,25,114,44,31,121,44,28,125,44,28,125,51,34,132,52,31,137,65,49,154,109,90,182,155,130,209,165,148,225,163,138,217,127,101,196,79,53,162,52,24,146,62,32,156,66,41,169,89,62,186,105,79,198,119,92,213,126,99,222,135,111,227,138,114,223,151,129,226,166,141,233,166,141,233,165,148,225,188,173,224,221,213,246,221,207,247,189,177,235,154,138,221,139,120,208,138,119,219,138,114,223,131,109,206,138,119,219,138,119,219,126,106,213,97,76,186,74,53,167,74,53,167,71,46,154,57,35,142,45,26,131,43,19,119,43,19,119,44,15,124,37,20,123,38,15,114,44,28,125,44,28,125,35,17,108,25,9,99,25,9,99,20,6,95,17,7,88,15,9,82,10,5,72,17,3,67,17,3,67,9,4,66,16,4,62,16,4,62,8,4,60,15,4,56,15,4,56,9,1,21,9,1,21,6,2,26,9,1,21,9,1,21,6,2,26,4,2,30,4,2,30,4,2,30,10,2,35,10,3,45,15,4,56,16,4,62,17,3,67,21,6,76,28,9,87,35,17,108,51,34,132,81,63,157,114,96,175,149,133,203,160,139,210,160,139,210,160,139,210,176,155,227,175,163,233,171,156,220,180,163,228,189,169,229,189,169,229,187,170,235,176,164,221,149,133,196,104,86,165,80,61,169,87,60,170,86,63,166,97,76,186,113,89,195,129,101,210,113,89,195,86,63,166,57,35,142,44,22,135,44,22,135,44,22,135,52,27,141,74,53,167,113,89,195,144,118,221,151,129,226,154,138,221,185,177,225,206,203,234,206,203,234,207,204,241,191,182,230,176,164,221,188,173,224,198,183,236,196,173,227,180,163,228,176,155,227,176,155,227,186,166,240,182,161,233,182,161,233,185,160,228,171,156,220,167,146,218,160,139,210,160,139,210,167,150,215,176,155,227,155,138,214,104,86,165,59,43,128,35,17,108,25,9,99,23,10,92,28,9,87,22,4,81,21,6,76,29,13,83,25,18,85,21,6,76,10,5,72,17,3,67,9,4,66,16,4,62,6,2,26,4,2,30,4,2,30,10,2,35,10,2,35,10,3,45,7,4,55,8,4,60,16,4,62,17,3,67,24,3,88,26,5,104,35,8,116,43,19,119,59,35,129,87,68,157,129,116,196,161,148,218,169,156,226,148,131,207,109,90,182,89,69,165,89,69,165,94,75,171,89,69,165,86,63,166,75,55,157,72,54,148,89,68,151,125,107,181,142,125,200,144,123,206,134,112,200,125,104,192,117,97,190,109,90,182,117,97,190,125,104,192,81,63,157,45,26,131,44,15,124,30,9,108,30,9,108,26,5,104,26,5,104,31,13,103,38,15,114,45,26,131,68,36,147,58,37,157,62,32,156,58,32,146,63,40,147,81,63,157,104,82,168,114,96,175,127,108,189,144,123,206,139,120,208,114,90,187,100,79,183,109,90,182,118,99,185,134,117,192,148,131,207,144,123,206,136,116,198,127,108,189,133,115,183,133,115,183,134,117,192,136,116,198,136,116,198,146,122,199,178,154,221,195,170,238,171,147,213,142,125,200,118,99,185,93,68,172,63,40,147,52,23,132,44,15,124,35,8,116,35,8,116,38,15,114,52,29,122,71,54,135,97,85,159,97,85,159,4,2,30,4,2,30,2,4,35,10,2,35,6,3,39,13,4,50,16,4,62,10,5,72,21,6,76,21,6,76,34,10,97,43,19,119,72,54,148,133,115,183,188,173,224,208,190,237,177,163,215,125,107,181,81,63,157,72,45,161,69,38,162,62,32,156,52,24,146,51,17,135,44,22,135,44,22,135,38,17,129,38,17,129,35,8,116,44,15,124,37,20,123,44,15,124,44,15,124,44,15,124,44,22,135,52,27,141,58,32,146,52,27,141,52,27,141,52,27,141,44,22,135,52,23,132,53,27,128,44,28,125,44,23,115,44,23,115,34,21,117,26,12,115,35,8,116,35,8,116,43,10,128,43,10,128,38,17,129,44,15,124,45,26,131,75,55,157,113,89,195,138,114,223,115,95,207,84,58,175,58,32,146,44,22,135,52,23,132,52,23,132,58,32,146,64,37,153,64,37,153,52,31,137,45,26,131,35,8,116,35,8,116,35,8,116,35,8,116,37,20,123,59,39,139,89,69,165,118,99,185,149,133,203,182,161,233,171,145,225,117,97,190,73,48,143,59,43,135,89,68,151,104,86,165,125,107,181,155,138,214,160,139,210,134,117,192,114,96,175,6,3,39,10,3,45,15,4,56,17,3,67,15,9,82,20,6,95,30,9,108,26,12,115,37,20,123,44,28,125,61,49,147,96,81,164,160,139,210,194,174,234,171,156,220,142,128,209,150,130,219,139,120,208,131,109,206,131,109,206,134,112,200,150,130,219,155,130,209,136,116,198,136,116,198,125,104,192,94,75,171,79,53,162,74,53,167,79,53,162,63,40,147,52,31,137,71,46,154,97,76,186,116,85,200,95,63,182,64,42,163,72,45,161,72,45,161,72,45,161,72,45,161,71,46,154,71,46,154,63,40,147,52,31,137,45,26,131,44,15,124,44,15,124,38,17,129,43,10,128,45,18,140,58,32,146,72,45,161,90,66,183,109,85,204,135,111,227,135,111,227,103,74,187,79,49,167,66,41,169,62,32,156,68,36,147,63,40,147,53,27,128,38,15,114,30,9,108,24,3,88,21,6,76,21,6,76,22,4,81,17,7,88,24,3,88,24,3,88,32,4,99,38,15,114,53,27,128,43,19,119,59,35,129,97,85,159,178,158,216,198,183,236,198,183,236,189,169,229,187,170,235,160,139,210,127,108,189,89,69,165,57,35,142,44,22,135,43,10,128,15,4,56,20,8,71,28,9,87,31,13,103,52,29,122,81,63,157,109,94,179,129,116,196,149,133,203,167,150,215,188,173,224,208,198,243,215,202,241,191,182,230,156,142,205,133,115,183,133,115,183,160,139,210,165,144,229,154,138,221,151,129,213,144,123,206,144,123,206,151,129,213,151,129,213,165,148,225,172,154,232,150,130,219,127,101,196,116,85,200,119,92,213,135,111,227,138,114,223,153,127,231,151,129,226,166,141,233,151,129,226,144,118,221,151,129,226,150,130,219,163,138,217,155,138,214,163,138,217,139,120,208,114,90,187,93,68,172,72,45,161,69,38,162,62,32,156,69,38,162,95,63,182,129,101,210,153,127,231,135,111,227,126,99,222,109,85,204,95,63,182,79,49,167,58,37,157,52,24,146,45,18,140,51,17,135,44,15,124,44,15,124,42,8,113,30,9,108,23,10,92,26,6,72,20,8,71,22,4,81,30,16,98,23,10,92,17,7,88,31,13,103,43,19,119,45,26,131,38,15,114,30,9,108,34,21,117,59,43,128,86,69,145,97,85,159,114,96,175,109,94,179,105,85,183,98,72,190,90,66,183,87,60,170,86,63,166,87,60,170,17,7,88,35,17,108,61,49,147,109,94,179,167,150,215,206,191,244,198,189,227,190,177,216,164,147,204,164,147,204,188,173,224,208,190,237,177,163,215,177,163,215,190,177,216,198,189,227,208,198,243,198,183,236,155,130,209,105,85,183,93,68,172,105,85,183,117,97,190,117,97,190,117,97,190,117,97,190,150,130,219,174,156,240,180,161,240,175,163,233,189,177,235,217,199,247,221,207,247,217,199,247,215,202,241,221,207,247,227,211,245,227,211,245,221,207,247,221,207,247,215,202,241,208,190,237,208,190,237,208,198,243,206,191,244,189,177,235,169,156,226,155,142,211,149,133,203,155,142,211,172,154,232,182,168,239,182,168,239,154,138,221,131,109,206,139,120,208,172,154,232,182,168,239,165,148,225,144,123,206,94,75,171,58,32,146,52,24,146,52,24,146,45,18,140,45,18,140,38,17,129,43,19,119,43,19,119,37,20,123,45,26,131,59,43,135,72,51,139,59,43,135,34,21,117,26,5,104,20,6,95,24,3,88,24,3,88,20,6,95,20,6,95,21,13,107,26,5,104,21,13,107,21,13,107,34,21,117,59,43,135,87,68,157,87,68,157,59,43,135,44,28,125,109,90,182,171,156,220,215,202,241,221,207,247,191,182,230,188,173,224,188,173,224,188,173,224,180,163,228,160,139,210,114,91,178,70,48,149,52,31,137,57,35,142,71,46,154,94,75,171,144,123,206,176,155,227,185,160,228,182,161,233,182,161,233,167,146,218,178,158,216,198,183,236,208,198,243,208,198,243,208,198,243,208,198,243,208,198,243,191,182,230,194,174,234,186,166,240,165,142,240,129,101,210,109,85,204,129,101,210,165,142,240,166,141,233,151,129,226,131,109,206,138,119,219,154,138,221,191,182,230,207,204,241,206,203,234,217,217,242,217,217,242,234,235,248,234,235,248,234,235,248,217,217,242,208,198,243,196,184,242,182,168,239,169,156,226,169,156,226,161,148,218,175,163,233,196,184,242,201,193,244,176,164,221,142,128,209,138,119,219,126,106,213,119,92,213,97,72,198,83,54,185,66,41,169,82,55,179,89,62,186,87,60,170,72,54,148,44,28,125,26,12,115,26,5,104,24,3,88,20,6,95,20,6,95,24,3,88,22,4,81,15,9,82,22,4,81,24,3,88,36,25,114,59,43,128,87,68,157,87,68,157,59,43,128,30,9,108,71,54,135,134,117,192,198,183,236,208,190,237,155,138,214,97,76,186,64,42,163,57,35,142,59,39,139,53,27,128,44,22,135,38,17,129,38,17,129,44,15,124,44,15,124,52,27,141,58,32,146,64,37,153,71,46,154,75,55,157,75,55,157,71,46,154,72,45,161,74,53,167,92,68,179,97,76,186,97,76,186,113,89,195,113,89,195,97,76,186,82,55,179,75,47,177,89,62,186,109,85,204,126,99,222,138,108,232,128,95,225,113,79,214,113,79,214,116,90,219,125,101,215,138,114,223,144,130,224,175,163,233,221,213,246,234,235,248,234,235,248,233,225,251,233,225,251,233,225,251,233,225,251,221,213,246,208,198,243,206,191,244,196,184,242,196,184,242,192,178,243,196,184,242,198,183,236,208,198,243,221,207,247,221,213,246,221,213,246,206,191,244,172,154,232,138,114,223,119,92,213,128,95,225,126,99,222,126,99,222,95,63,182,84,58,175,80,61,169,65,49,154,53,40,143,34,21,117,31,13,103,34,10,97,23,10,92,25,9,99,25,9,99,31,13,103,45,30,113,81,68,150,109,94,179,118,99,185,96,81,164,59,43,128,31,13,103,26,5,104,68,49,118,133,115,183,164,147,204,189,169,229,171,147,213,104,82,168,57,35,142,45,26,131,37,20,123,52,23,132,53,27,128,72,54,148,105,83,175,118,99,185,125,104,192,118,97,197,108,86,197,105,79,198,98,72,190,89,62,186,89,62,186,95,63,182,79,49,167,58,37,157,52,24,146,51,17,135,38,17,129,38,17,129,38,17,129,44,22,135,52,27,141,71,46,154,118,97,197,171,141,228,165,144,229,171,145,225,165,144,229,165,144,229,165,148,225,171,156,220,187,170,235,182,168,239,187,170,235,208,198,243,215,202,241,188,173,224,148,131,207,134,112,200,150,130,219,166,141,233,165,142,240,165,142,240,165,142,240,151,129,226,144,118,221,126,106,213,125,101,215,125,101,215,116,85,200,98,72,190,97,76,186,117,97,190,149,133,203,190,177,216,227,211,245,201,193,244,174,156,240,151,129,226,135,111,227,109,85,204,108,86,197,115,95,207,125,101,215,138,114,223,126,106,213,100,79,183,80,61,169,72,54,148,75,55,157,65,49,154,70,48,149,89,68,151,136,116,198,134,112,200,87,68,157,45,30,113,30,16,98,30,6,92,25,9,99,32,4,99,17,7,88,31,13,103,59,35,129,104,86,165,167,146,218,182,161,233,178,154,221,171,147,213,156,142,205,164,147,204,178,158,216,194,174,234,192,178,243,180,163,228,167,146,218,167,146,218,172,154,232,163,138,217,114,91,178,63,40,147,51,17,135,41,15,137,41,15,137,41,15,137,43,10,128,38,17,129,38,17,129,41,15,137,45,18,140,58,32,146,93,68,172,146,122,199,195,170,238,195,170,238,185,160,228,185,160,228,185,160,228,187,170,235,189,169,229,188,173,224,188,173,224,189,169,229,187,170,235,176,155,227,134,112,200,108,86,197,79,49,167,62,32,156,58,32,146,57,35,142,71,46,154,71,46,154,79,53,162,92,68,179,116,85,200,116,85,200,98,72,190,82,55,179,75,47,177,66,41,169,66,41,169,62,30,163,72,37,171,100,79,183,167,146,218,208,198,243,221,207,247,227,211,245,233,225,251,221,213,246,221,213,246,221,213,246,221,213,246,221,213,246,221,213,246,221,207,247,206,191,244,199,179,239,194,174,234,189,177,235,189,169,229,182,161,233,151,129,213,105,83,175,87,68,157,81,68,150,97,85,159,119,101,168,133,115,183,133,115,183,13,4,50,16,4,62,26,6,72,29,13,83,47,33,104,71,54,135,77,61,136,81,68,150,96,81,164,96,81,164,96,81,164,89,68,151,72,51,139,51,34,132,52,23,132,58,32,146,86,63,166,136,116,198,176,155,227,148,131,207,104,82,168,73,48,143,59,39,139,52,23,132,52,27,141,52,24,146,52,24,146,68,36,147,104,82,168,167,146,218,182,161,233,178,150,224,146,122,199,114,91,178,87,68,157,72,54,148,72,54,148,70,48,149,53,40,143,53,40,143,61,49,147,87,68,157,87,68,157,59,43,128,52,29,122,59,39,139,70,48,149,70,48,149,70,48,149,53,27,128,38,15,114,35,8,116,30,9,108,38,15,114,59,35,129,81,63,157,93,68,172,92,68,179,84,58,175,72,45,161,79,49,167,79,49,167,66,41,169,66,41,169,72,45,161,93,68,172,125,104,192,144,123,206,165,148,225,180,161,240,180,161,240,174,156,240,180,161,240,187,170,235,165,148,225,165,144,229,182,168,239,194,174,234,196,184,242,206,191,244,221,207,247,227,211,245,221,213,246,215,202,241,207,204,241,221,213,246,221,207,247,196,184,242,155,138,214,118,97,197,4,2,30,6,3,39,13,4,50,16,4,62,17,3,67,15,9,82,22,4,81,22,4,81,22,4,81,17,7,88,24,3,88,24,3,88,24,3,88,24,3,88,24,3,88,25,9,99,26,12,115,53,40,143,114,96,175,160,139,210,176,155,227,178,154,221,178,154,221,160,139,210,144,124,194,144,124,194,144,124,194,142,125,200,171,145,225,171,145,225,105,83,175,58,32,146,44,22,135,44,15,124,30,9,108,25,9,99,23,10,92,25,9,99,20,6,95,30,6,92,20,6,95,25,9,99,21,13,107,25,9,99,30,6,92,23,10,92,23,10,92,25,9,99,31,13,103,38,15,114,38,15,114,38,15,114,30,9,108,30,9,108,30,9,108,30,9,108,43,19,119,52,31,137,68,36,147,58,32,146,52,24,146,62,32,156,64,42,163,82,55,179,95,63,182,98,72,190,98,72,190,95,63,182,89,62,186,82,55,179,92,68,179,118,97,197,144,130,224,174,156,240,165,144,229,144,130,224,126,106,213,115,95,207,138,114,223,151,129,226,166,141,233,165,144,229,174,156,240,175,163,233,171,156,220,161,148,218,148,131,207,142,128,209,150,130,219,139,120,208,6,2,26,4,2,30,2,4,35,10,2,35,6,3,39,6,3,39,10,2,35,10,2,35,10,3,45,10,3,45,5,4,49,13,4,50,5,4,49,10,3,45,13,4,50,16,4,62,22,4,81,20,6,95,25,9,99,34,21,117,53,27,128,72,54,148,117,97,190,136,116,198,134,117,192,133,115,183,133,115,183,134,117,192,114,96,175,72,51,139,43,19,119,30,9,108,26,5,104,30,16,98,21,6,76,9,4,66,9,4,66,9,4,66,9,4,66,16,4,62,16,4,62,16,4,62,17,3,67,17,3,67,9,4,66,8,4,60,16,4,62,17,3,67,10,5,72,21,6,76,26,6,72,29,13,83,28,9,87,30,6,92,20,6,95,34,10,97,34,10,97,30,6,92,30,6,92,25,9,99,25,9,99,25,9,99,30,6,92,30,6,92,30,16,98,30,16,98,31,13,103,31,13,103,21,13,107,21,13,107,34,21,117,44,28,125,59,43,135,96,81,164,129,116,196,142,125,200,142,125,200,142,128,209,142,128,209,118,99,185,105,85,183,92,68,179,92,68,179,97,76,186,108,86,197,105,79,198,98,72,190,71,46,154,51,34,132,44,31,121,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,1,3,21,1,3,21,1,3,21,1,3,21,9,1,21,9,1,21,4,2,30,6,3,39,5,4,49,7,4,55,8,4,60,22,4,81,30,9,108,59,39,139,86,63,166,63,40,147,44,22,135,44,22,135,58,32,146,62,32,156,58,37,157,52,27,141,44,15,124,37,20,123,26,12,115,25,9,99,21,6,76,16,4,62,9,4,66,9,4,66,16,4,62,15,4,56,13,4,50,13,4,50,10,3,45,10,2,35,6,2,26,1,3,21,1,3,21,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,3,39,13,4,50,16,4,62,16,4,62,16,4,62,8,4,60,15,4,56,15,4,56,7,4,55,7,4,55,13,4,50,5,4,49,5,4,49,13,4,50,13,4,50,7,4,55,15,4,56,15,4,56,16,4,62,21,6,76,22,4,81,22,4,81,28,9,87,29,16,92,29,16,92,29,16,92,29,13,83,28,9,87,28,9,87,22,4,81,23,10,92,28,9,87,28,9,87,36,25,114,59,39,139,75,55,157,61,49,147,44,31,121,9,1,21,9,1,21,1,3,21,1,3,21,1,3,21,1,3,21,1,3,21,1,3,21,1,3,21,1,3,21,0,4,25,0,4,25,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,10,2,35,16,4,62,17,7,88,30,16,98,59,43,128,73,48,143,70,48,149,75,55,157,70,48,149,52,31,137,52,23,132,53,27,128,52,29,122,59,35,129,59,43,135,72,51,139,59,49,127,47,32,110,30,16,98,15,9,82,20,8,71,7,4,55,10,3,45,10,3,45,10,3,45,10,2,35,4,2,30,6,2,26,6,2,26,6,2,26,6,2,26,1,3,21,6,2,26,4,2,30,4,2,30,2,4,35,10,2,35,6,3,39,6,3,39,10,3,45,10,3,45,5,4,49,10,3,45,10,3,45,10,3,45,6,3,39,6,3,39,6,3,39,14,2,40,10,3,45,10,3,45,10,3,45,5,4,49,10,3,45,6,3,39,10,3,45,10,3,45,5,4,49,5,4,49,10,3,45,10,3,45,10,3,45,10,3,45,13,4,50,5,4,49,10,3,45,10,3,45,10,3,45,15,4,56,22,18,79,47,33,104,47,33,104,9,1,21,9,1,21,9,1,21,1,3,21,1,3,21,1,3,21,1,3,21,9,1,21,9,1,21,9,1,21,6,2,26,6,2,26,6,2,26,6,2,26,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,4,2,30,10,2,35,6,3,39,5,4,49,7,4,55,8,4,60,16,4,62,17,3,67,21,6,76,17,3,67,15,4,56,10,3,45,10,3,45,13,4,50,15,4,56,16,4,62,10,5,72,21,6,76,10,5,72,15,4,56,10,3,45,10,2,35,4,2,30,4,2,30,6,2,26,9,1,21,1,3,21,9,1,21,9,1,21,9,1,21,1,3,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,6,2,26,6,2,26,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,9,1,21,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,6,2,26,4,2,30,4,2,30,4,2,30,6,2,26,6,2,26,6,2,26,6,2,26,4,2,30,4,2,30};
void povB() {
  int pixels = 90;
  int frames = 22;
  int fps = 1;
  static int currentFrame = 0;

  for (int i=0; i<NUM_LEDS; i++) {
    int pixelIndex = i % pixels;
    int index = currentFrame*pixels*3 + pixelIndex*3;

    // Note: We're using pgm_read_byte_near to read bytes out of the data array stored in PROGMEM. These functions are not required for all configurations
    leds[i] = CRGB(pgm_read_byte_near(dataB+index),pgm_read_byte_near(dataB+index+1),pgm_read_byte_near(dataB+index+2));
  }
  FastLED.show();
  currentFrame ++;
  if (currentFrame >= frames) currentFrame = 0;
}

const byte dataC[] PROGMEM = {198,182,56,212,201,65,216,210,63,218,212,66,213,208,61,208,204,66,190,193,61,165,183,55,152,172,52,126,160,44,108,150,40,85,135,32,76,127,22,63,123,26,61,121,24,58,119,30,61,115,35,65,106,43,60,95,63,61,83,76,62,68,102,66,51,125,67,39,141,69,23,160,71,13,172,67,9,184,70,3,191,70,3,191,81,0,181,96,0,167,100,5,157,116,0,146,127,0,135,133,0,127,143,6,117,155,0,106,163,7,96,176,0,81,184,0,74,198,0,60,206,6,50,215,0,37,228,0,32,239,0,15,249,0,11,189,168,52,204,193,57,218,206,61,218,212,66,218,212,66,211,206,59,195,197,57,179,189,55,158,176,47,139,166,43,118,153,36,100,142,32,82,132,28,65,125,28,61,121,24,60,120,22,62,115,28,62,110,39,61,100,55,60,87,74,67,76,88,64,59,113,61,45,137,68,32,151,65,21,172,65,7,183,70,3,191,70,3,191,76,0,186,86,0,175,96,7,163,105,7,154,119,0,141,130,0,131,140,3,120,151,0,109,159,0,98,172,0,89,184,0,74,190,0,67,202,0,58,214,0,42,223,0,35,236,0,21,249,0,11,181,161,53,197,181,55,212,201,65,218,212,66,218,212,66,215,209,62,201,203,62,186,196,62,165,183,55,144,170,48,126,160,44,104,147,37,85,135,32,76,127,22,63,123,26,61,121,24,59,119,21,59,113,33,58,108,43,60,95,63,60,80,84,62,68,102,66,51,125,67,35,146,69,23,160,65,15,177,67,9,184,70,3,191,76,0,186,81,0,181,96,0,167,104,5,153,112,5,145,127,0,135,137,2,124,144,5,112,156,0,101,168,0,91,176,0,81,188,0,71,198,0,60,206,6,50,218,3,39,228,0,32,239,0,15,171,146,48,191,176,58,204,193,57,218,206,61,218,212,66,218,212,66,211,206,59,195,197,57,178,188,54,159,177,48,131,164,39,117,151,35,97,139,28,80,130,26,65,125,28,61,121,24,61,121,24,62,115,28,60,109,44,63,101,51,60,87,74,65,72,95,64,59,113,67,42,137,68,27,155,64,20,171,67,9,184,70,3,191,70,3,191,81,0,181,91,0,171,96,7,163,113,0,150,119,0,141,130,0,131,142,4,116,151,0,109,162,4,95,172,0,89,184,0,74,192,3,64,203,0,53,214,0,42,228,0,32,231,4,19,163,139,49,181,161,53,203,186,60,212,201,65,218,212,66,218,212,66,215,209,62,201,203,62,181,191,57,170,182,56,144,170,48,121,156,39,104,147,37,84,134,31,66,126,29,62,122,25,61,121,24,58,119,30,59,113,33,61,105,47,60,95,63,60,80,84,67,63,105,65,50,124,67,35,146,63,24,165,65,15,177,70,3,191,70,3,191,76,0,186,86,0,175,96,0,167,109,0,154,113,7,146,127,0,135,136,0,123,149,0,113,156,0,101,168,0,91,176,0,81,188,0,71,199,0,56,206,6,50,218,3,39,230,0,26,149,121,40,175,155,47,191,176,58,207,196,60,216,210,63,218,212,66,216,210,63,208,204,66,195,197,57,176,186,51,158,176,47,135,162,39,108,150,40,97,139,28,80,130,26,63,123,26,61,121,24,60,120,22,63,116,29,60,109,44,64,98,60,60,87,74,65,72,95,64,56,116,61,45,137,68,27,155,71,13,172,67,9,184,70,3,191,70,3,191,81,0,181,91,0,171,96,7,163,109,7,150,123,0,138,130,0,131,141,1,115,155,0,106,162,4,95,174,0,85,184,0,74,192,3,64,204,2,54,214,0,42,228,0,32,141,103,34,163,139,49,189,168,52,203,186,60,216,204,59,218,212,66,218,212,66,211,206,59,201,203,62,181,191,57,161,179,51,144,170,48,121,156,39,100,142,32,85,135,32,66,126,29,62,122,25,60,120,22,58,119,30,59,113,33,61,105,47,61,91,66,60,80,84,62,65,105,65,47,128,67,35,146,63,24,165,65,7,183,70,3,191,70,3,191,76,0,186,86,0,175,95,5,162,109,0,154,119,0,141,127,0,135,136,0,123,149,0,113,159,0,98,168,0,91,176,0,81,190,0,67,199,0,56,212,0,46,218,3,39,131,95,32,149,121,40,178,152,46,197,181,55,209,197,61,216,210,63,218,212,66,216,210,63,203,205,65,195,197,57,175,185,50,154,173,44,135,162,39,108,150,40,85,135,32,78,129,25,63,123,26,61,121,24,60,120,22,61,115,35,60,109,44,58,99,60,62,84,77,65,72,95,64,56,116,67,39,141,68,27,155,71,13,172,67,9,184,70,3,191,70,3,191,81,0,181,91,0,171,101,7,158,109,7,150,123,0,138,133,0,127,142,4,116,155,0,106,163,7,96,174,0,85,184,0,74,198,0,60,204,2,54,215,0,37,117,78,31,145,113,41,163,139,49,190,169,53,203,193,65,216,204,59,218,212,66,218,212,66,213,208,61,195,197,57,181,191,57,162,180,52,139,166,43,121,156,39,100,142,32,82,132,28,67,127,30,62,122,25,60,120,22,56,118,29,62,110,39,59,104,52,61,91,66,64,75,92,67,63,105,65,47,128,68,32,151,63,24,165,65,7,183,70,3,191,70,3,191,76,0,186,86,0,175,96,7,163,105,7,154,119,0,141,130,0,131,140,3,120,149,0,113,159,0,98,172,0,89,179,5,78,190,0,67,202,0,53,212,0,46,107,59,24,131,95,32,158,129,41,175,155,47,198,182,56,212,201,65,216,210,63,218,212,66,215,209,62,208,204,66,192,194,53,175,185,50,148,174,52,126,160,44,108,150,40,88,139,35,71,129,23,64,124,27,60,120,22,58,119,30,63,116,29,58,108,43,58,99,60,62,84,77,62,68,102,64,56,116,67,39,141,69,23,160,71,13,172,68,10,185,70,3,191,70,3,191,81,0,181,96,0,167,100,5,157,116,0,146,123,0,138,133,0,127,143,6,117,155,0,106,163,7,96,176,0,81,184,0,74,198,0,60,206,6,50,99,53,24,120,76,32,144,112,40,171,146,48,189,168,52,203,193,65,218,206,61,218,212,66,218,212,66,211,206,59,195,197,57,179,189,55,162,180,52,139,166,43,118,153,36,100,142,32,82,132,28,64,124,27,62,122,25,60,120,22,63,116,29,62,110,39,63,101,51,61,91,66,61,76,87,64,59,113,65,47,128,68,32,151,64,20,171,65,7,183,70,3,191,70,3,191,76,0,186,86,0,175,101,0,163,105,7,154,119,0,141,127,0,135,138,0,119,151,0,109,156,0,101,172,0,89,184,0,74,190,0,67,202,0,58,89,34,17,112,69,25,131,95,32,158,129,41,181,161,53,197,181,55,212,201,65,218,212,66,218,212,66,215,209,62,201,203,62,192,194,53,170,182,56,152,172,52,126,160,44,103,146,36,85,135,32,76,127,22,62,122,25,61,121,24,58,119,30,60,114,34,65,106,43,60,95,63,62,84,77,62,68,102,66,51,125,67,39,141,69,23,160,65,15,177,67,9,184,70,3,191,76,0,186,81,0,181,96,0,167,104,5,153,113,7,146,127,0,135,133,0,127,143,6,117,156,0,101,163,7,96,176,0,81,188,0,71,198,0,60,82,28,17,99,53,24,125,85,32,144,112,40,171,146,48,191,176,58,203,193,65,218,206,61,218,212,66,218,212,66,205,207,67,195,197,57,179,189,55,159,177,48,139,166,43,117,151,35,91,141,28,82,132,28,65,125,28,60,120,22,60,120,22,63,116,29,60,109,44,63,101,51,60,87,74,65,72,95,64,59,113,61,45,137,68,32,151,64,20,171,67,9,184,70,3,191,70,3,191,81,0,181,91,0,171,96,7,163,109,7,150,119,0,141,130,0,131,138,0,119,151,0,109,162,4,95,172,0,89,183,0,79,192,3,64,72,13,11,94,44,18,112,69,25,139,102,40,158,129,41,181,161,53,198,188,60,212,201,65,218,212,66,218,212,66,215,209,62,200,202,61,181,191,57,165,183,55,144,170,48,126,160,44,104,147,37,85,135,32,76,127,22,62,122,25,60,120,22,59,119,21,59,113,33,61,105,47,61,96,64,61,81,85,62,65,105,66,51,125,67,35,146,69,23,160,65,15,177,70,3,191,70,3,191,76,0,186,86,0,175,96,0,167,104,5,153,119,0,141,127,0,135,136,0,123,143,6,117,156,0,101,168,0,91,176,0,81,188,0,71,61,4,12,82,28,17,107,59,24,125,85,32,149,121,40,171,146,48,191,176,58,207,196,60,218,206,61,218,212,66,216,210,63,211,206,59,195,197,57,176,186,51,158,176,47,131,164,39,117,151,35,97,139,28,80,130,26,65,125,28,61,121,24,59,119,21,63,116,29,60,109,44,58,99,60,60,87,74,65,72,95,64,56,116,61,45,137,68,27,155,64,20,171,67,9,184,70,3,191,70,3,191,81,0,181,91,0,171,96,7,163,109,7,150,123,0,138,131,0,132,142,4,116,151,0,109,162,4,95,174,0,85,184,0,74,58,1,7,72,13,11,93,43,23,120,76,32,139,102,40,163,139,49,181,161,53,203,186,60,212,201,65,218,212,66,218,212,66,213,208,61,201,203,62,181,191,57,161,179,51,144,170,48,121,156,39,104,147,37,85,135,32,66,126,29,62,122,25,61,121,24,56,118,29,59,113,33,61,105,47,62,92,66,60,80,84,67,63,105,67,48,129,67,35,146,63,24,165,65,15,177,70,3,191,70,3,191,76,0,186,86,0,175,95,5,162,105,7,154,119,0,141,127,0,135,136,0,123,149,0,113,156,0,101,168,0,91,179,5,78,51,2,8,67,8,12,82,28,17,107,59,24,132,96,33,149,121,40,178,152,46,191,176,58,209,197,61,216,210,63,218,212,66,216,210,63,203,205,65,195,197,57,176,186,51,154,173,44,131,164,39,108,150,40,88,139,35,80,130,26,64,124,27,61,121,24,60,120,22,63,116,29,60,109,44,58,99,60,61,83,76,65,72,95,64,56,116,67,39,141,68,27,155,71,13,172,67,9,184,70,3,191,70,3,191,81,0,181,91,0,171,100,5,157,109,7,150,123,0,138,133,0,127,141,1,115,155,0,106,159,0,98,174,0,85,49,0,5,58,1,7,75,23,17,93,43,23,117,78,31,144,112,40,163,139,49,189,168,52,198,188,60,215,204,68,218,212,66,218,212,66,213,208,61,195,197,57,181,191,57,161,179,51,139,166,43,121,156,39,100,142,32,82,132,28,67,127,30,62,122,25,60,120,22,56,118,29,62,110,39,61,105,47,62,92,66,67,76,88,62,65,105,67,48,129,68,32,151,63,24,165,73,6,178,70,3,191,70,3,191,76,0,186,86,0,175,96,7,163,105,7,154,119,0,141,130,0,131,140,3,120,149,0,113,159,0,98,168,0,91,45,1,2,51,2,8,67,8,12,86,37,17,107,59,24,131,95,32,158,129,41,175,155,47,197,181,55,209,197,61,218,212,66,218,212,66,216,210,63,203,205,65,190,193,61,176,186,51,149,174,43,126,160,44,108,150,40,88,139,35,76,127,22,63,123,26,61,121,24,60,120,22,61,115,35,61,105,47,58,99,60,61,83,76,62,68,102,64,56,116,67,39,141,69,23,160,71,13,172,68,10,185,70,3,191,70,3,191,81,0,181,91,0,171,100,5,157,113,7,146,123,0,138,133,0,127,144,5,112,155,0,106,163,7,96,45,1,2,49,0,5,58,1,7,75,23,17,99,53,24,120,76,32,144,112,40,171,146,48,190,169,53,203,193,65,218,206,61,218,212,66,218,212,66,213,208,61,195,197,57,179,189,55,162,180,52,139,166,43,117,151,35,100,142,32,82,132,28,65,125,28,61,121,24,60,120,22,56,118,29,62,110,39,63,101,51,61,91,66,67,76,88,64,59,113,65,47,128,68,32,151,64,20,171,65,7,183,70,3,191,70,3,191,76,0,186,91,0,171,95,5,162,109,0,154,119,0,141,130,0,131,138,0,119,151,0,109,159,0,98};
void povC() {
  int pixels = 90;
  int frames = 22;
  int fps = 1;
  static int currentFrame = 0;

  for (int i=0; i<NUM_LEDS; i++) {
    int pixelIndex = i % pixels;
    int index = currentFrame*pixels*3 + pixelIndex*3;

    // Note: We're using pgm_read_byte_near to read bytes out of the data array stored in PROGMEM. These functions are not required for all configurations
    leds[i] = CRGB(pgm_read_byte_near(dataC+index),pgm_read_byte_near(dataC+index+1),pgm_read_byte_near(dataC+index+2));
  }
  FastLED.show();
  currentFrame ++;
  if (currentFrame >= frames) currentFrame = 0;
}


void lightning() 
{
  for (int flashCounter = 0; flashCounter < random8(3,FLASHES); flashCounter++)
  {
    if(flashCounter == 0) dimmer = 5;     // the brightness of the leader is scaled down by a factor of 5
    else dimmer = random8(1,3);           // return strokes are brighter than the leader
    
    FastLED.showColor(CHSV(255, 0, 255/dimmer));
    delay(random8(4,10));                 // each flash only lasts 4-10 milliseconds
    FastLED.showColor(CHSV(255, 0, 0));
    
    if (flashCounter == 0) delay (150);   // longer delay until next flash after the leader
    delay(50+random8(100));               // shorter delay between strokes  
  }
  delay(random8(FREQUENCY)*10);          // delay between strikes
}

void meteor(){
  // slide all the pixels down one in the array
  memmove8( &leds[1], &leds[0], (NUM_LEDS - 1) * 3 );

  // increment the meteor display frame
  idex++;
  // make sure we don't drift into space
  if ( idex > meteorLength ) {
    idex = 0;
    // cycle through hues in each successive meteor tail
    hue += 32;  
  }

  // this switch controls the actual meteor animation, i.e., what gets placed in the
  // first position and then subsequently gets moved down the strip by the memmove above
  switch ( idex ) {
  case 0:
    leds[0] = CRGB(200,200,200); 
    break;
  case 1:
    leds[0] = CHSV((hue - 20), 255, 210); 
    break;
  case 2:
    leds[0] = CHSV((hue - 22), 255, 180); 
    break;
  case 3:
    leds[0] = CHSV((hue - 23), 255, 150); 
    break;
  case 4:
    leds[0] = CHSV((hue - 24), 255, 110); 
    break;
  case 5:
    leds[0] = CHSV((hue - 25), 255, 90); 
    break;
  case 6:
    leds[0] = CHSV((hue - 26), 160, 60); 
    break;
  case 7:
    leds[0] = CHSV((hue - 27), 140, 40); 
    break;
  case 8:
    leds[0] = CHSV((hue - 28), 120, 20); 
    break;
  case 9:
    leds[0] = CHSV((hue - 29), 100, 20); 
    break;
  default:
    leds[0] = CRGB::Black; 
  }

  // show the blinky
  FastLED.show();  
  // control the animation speed/frame rate
  delay(20);
} 

void colorshift() {
    //beatsin16 is a function on the FastLED library generating sinwave, (5) is bpm, (0,255) is value range.
    //value range will create the breathing effect 
    //int pos = beatsin16(5,0,192); // generating the sinwave 
    fill_solid(leds, NUM_LEDS, CHSV( gHue, 255, 255)); // CHSV (hue, saturation, value);
    FastLED.show();
    EVERY_N_MILLISECONDS(100) {gHue++;} 
    // shifting the HUE value by incrementing every millisecond this creates the spectrum wave

    /* spectrum wave
     * fill_solid(leds, NUM_LEDS, CHSV( gHue, 255, 255)); // remove pos
     * FastLED.show();
     * EVERY_N_MILLISECONDS(100) {gHue++;} 
     */
     //additional codes, just to share
    /* color spectrum generator
     *  fill_rainbow( leds, NUM_LEDS, gHue, 3);
     */
}
